<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="UTF-8">
  <title>sidenotes - hardscrabble</title>
  <meta content="Max Jacobson" name="author">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="/feed.xml" rel="alternate" title="Posts feed" type="application/atom+xml">
  <link href="/img/favicon.ico" rel="icon" type="image/x-icon">
  <link rel="stylesheet" href="/css/lib/pinboard.css">
<link rel="stylesheet" href="/css/lib/normalize.css">
<link rel="stylesheet" href="/css/lib/solarized.css">
<link rel="stylesheet" href="/css/style.css">



  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', "UA-4982721-15", 'auto');
  ga('send', 'pageview');

</script>


</head>
<body>

<header>
  <h1><a href="/">hardscrabble</a></h1>
  <nav>
    <a href="/">home</a>
    | <a href="/about/">about</a>
    | <a href="/metaphorloop/">metaphor loop</a>
    | <a href="/search/">search</a>
    | <a href="/links/">links</a>
  </nav>
</header>

<div class="post">

  <div class="metadata">
    <div class="title">
      <h2>
        sidenotes
      </h2>
    </div>
    <div class="byline">
      by <a href="/about">Max Jacobson</a>
    </div>
    <div class="date">
      27 Dec 2013
    </div>
  </div>

  <div class="body">
    <p><strong>EDIT April 2015</strong>: I took it off the site because it was kind of bad <img class="emoji" title=":smile:" alt=":smile:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f604.png" height="20" width="20" align="absmiddle"></p>

<h3 id="background">background</h3>

<p>There’s a hubbub<sup id="fnref:hubbub"><a href="#fn:hubbub" class="footnote">1</a></sup> going around about a fun plugin for popover footnotes called Bigfoot.</p>

<p>I think it’s cool. I definitely prefer that reading experience.</p>

<h3 id="this-new-thing">this new thing</h3>

<p>Some people on Twitter said they prefer Grantland’s sidenotes, except for their behavior on mobile, where they basically don’t work. They imagined a solution that involves swiping/dragging, and <a href="https://twitter.com/RagingTBolt/statuses/416606618197843969">enlisted me</a> to work on it.</p>

<p>I’m not sure how to capture that kind of touch event and I’m curious to find out I guess.</p>

<p>I’m starting by recreating Grantland’s sidenotes, and then I’m going to go watch The Hobbit with my dad.</p>

<p>One thing that’s cool about the popular plugin is that it’s easy to drop in and use. What I’ve added to my site isn’t, because it makes assumptions about the structure of your HTML layout. I bet it could be abstracted in a way that’s broadly usable but I’m not sure how. Happy to take input on that!<sup id="fnref:opensource"><a href="#fn:opensource" class="footnote">2</a></sup></p>

<h3 id="assumptions-it-makes">assumptions it makes</h3>

<p>Here are the assumptions I’m currently making:</p>

<p>That your HTML layout looks something like this:</p>

<div class="language-html highlighter-rouge">
<pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"post"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"body"</span><span class="nt">&gt;</span>...<span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"sidenotes"</span><span class="nt">&gt;&lt;ol&gt;&lt;/ol&gt;&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"clearfix"</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre>
</div>

<p>And your CSS (<a href="http://sass-lang.com/">Sass</a> here) looks something like this:</p>

<div class="language-sass highlighter-rouge">
<pre class="highlight"><code><span class="nc">.post</span>
  <span class="nc">.body</span>
    <span class="nl">width</span><span class="p">:</span> <span class="m">70%</span>
    <span class="nl">float</span><span class="p">:</span> <span class="nb">left</span>
  <span class="nc">.sidenotes</span>
    <span class="nl">width</span><span class="p">:</span> <span class="m">25%</span>
    <span class="nl">float</span><span class="p">:</span> <span class="nb">left</span>
  <span class="nc">.clearfix</span>
    <span class="nl">clear</span><span class="p">:</span> <span class="nb">both</span>
</code></pre>
</div>

<p>I’m also assuming that your footnotes look a lot like the ones generated by my favored markdown-to-html processor, <a href="http://kramdown.gettalong.org/">kramdown</a>, which … I have <em>no</em> idea if that’ll be a dealbreaker for interoperablity.</p>

<p>Here’s what the code looks like<sup id="fnref:nostalgia"><a href="#fn:nostalgia" class="footnote">3</a></sup>:</p>

<div class="language-coffee highlighter-rouge">
<pre class="highlight"><code><span class="nx">$</span> <span class="o">-&gt;</span>
  <span class="c1"># grab the sidenotes divs</span>
  <span class="nx">$sidenotes_container</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s">".sidenotes"</span><span class="p">)</span>

  <span class="c1"># grab the sidenotes list</span>
  <span class="nx">$sidenotes</span> <span class="o">=</span> <span class="nx">$sidenotes_container</span><span class="p">.</span><span class="na">find</span> <span class="s">"ol"</span>

  <span class="c1"># iterate over the footnotes at the bottom of the post</span>
  <span class="c1"># and work some magic on them</span>
  <span class="nx">$</span><span class="p">(</span><span class="s">".footnotes li"</span><span class="p">).</span><span class="na">each</span> <span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">item</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="c1"># wrap the footnote in a jQuery object</span>
    <span class="nx">$footnote</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span>

    <span class="c1"># move the footnote from the bottom to the right</span>
    <span class="nx">$footnote</span><span class="p">.</span><span class="na">remove</span><span class="p">().</span><span class="na">appendTo</span> <span class="nx">$sidenotes</span>

    <span class="c1"># remove the little arrow that links back to the source</span>
    <span class="nx">$footnote</span><span class="p">.</span><span class="na">find</span><span class="p">(</span><span class="s">".reversefootnote"</span><span class="p">).</span><span class="na">remove</span><span class="p">()</span>

    <span class="c1"># find the source link from within the body of the post</span>
    <span class="nx">$source</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s">".footnote"</span><span class="p">).</span><span class="na">eq</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span>

    <span class="c1"># grab the previous sidenote, if there is one</span>
    <span class="nx">$previous_sidenote</span> <span class="o">=</span> <span class="nx">$footnote</span><span class="p">.</span><span class="na">prev</span><span class="p">()</span>
    <span class="nx">$previous_sidenote</span> <span class="o">=</span> <span class="k">if</span> <span class="nx">$previous_sidenote</span><span class="p">.</span><span class="na">length</span> <span class="k">then</span> <span class="nx">$previous_sidenote</span> <span class="k">else</span> <span class="no">undefined</span>

    <span class="c1"># let's set the vertical position of the current sidenote</span>
    <span class="c1"># if the previous one is kind of long, we need to push this one down</span>
    <span class="c1"># if not, it should be aligned with the source link</span>
    <span class="nx">$footnote</span><span class="p">.</span><span class="na">offset</span> <span class="o">-&gt;</span>
      <span class="nx">aligned_top</span> <span class="o">=</span> <span class="nx">$source</span><span class="p">.</span><span class="na">offset</span><span class="p">().</span><span class="na">top</span>
      <span class="k">if</span> <span class="nx">$previous_sidenote</span><span class="o">?</span> <span class="o">and</span> <span class="nx">$previous_sidenote</span><span class="p">.</span><span class="na">offset</span><span class="p">().</span><span class="na">top</span> <span class="o">+</span> <span class="nx">$previous_sidenote</span><span class="p">.</span><span class="na">height</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="nx">aligned_top</span>
        <span class="na">top</span><span class="o">:</span> <span class="nx">$previous_sidenote</span><span class="p">.</span><span class="na">offset</span><span class="p">().</span><span class="na">top</span> <span class="o">+</span> <span class="nx">$previous_sidenote</span><span class="p">.</span><span class="na">height</span><span class="p">()</span> <span class="o">+</span> <span class="mi">5</span>
      <span class="k">else</span>
        <span class="na">top</span><span class="o">:</span> <span class="nx">aligned_top</span>
</code></pre>
</div>

<h3 id="gripes--todos">gripes / todos</h3>

<ul>
  <li>looks bad on mobile, and when resizing the windows. Should have some responsiveness, possibly including that swiping thing @smarterbits imagined</li>
  <li>when you click a footnote link, nothing seems to happen. maybe the related sidenote should pulse briefly to attract the eye</li>
  <li>I don’t like how posts without sidenotes kind of look unbalanced now. This makes me want to have at least one footnote per post? Weird.</li>
  <li>vertical positions are screwed up when a post includes an embedded tweet, because the tweet’s height grows as Twitter’s JavaScript reformats the HTML from a vanilla blockquote to a whole thing, by which time my code has already set a height for all the sidenotes</li>
</ul>
<div class="footnotes">
  <ol>
    <li id="fn:hubbub">
      <p>I noticed it linked by <a href="http://www.leancrew.com/all-this/2013/12/tweaking-bigfoot-footnotes/">Dr. Drang</a>, who praised it for being “webby”, and <a href="http://www.marco.org/2013/12/15/bigfoot">Marco Arment</a> who praised it for being like Instapaper. <a href="#fnref:hubbub" class="reversefootnote">↩</a></p>
    </li>
    <li id="fn:opensource">
      <p>truthfully I’m eager to make some kind of open source thing that people use and collaboratively improve. <a href="#fnref:opensource" class="reversefootnote">↩</a></p>
    </li>
    <li id="fn:nostalgia">
      <p>I’m archiving it and not linking to the source either here or on GitHub because it’s very liable to change and I want to archive its current state for reference or more likely nostalgia. Actually, I <em>could</em> link to the sidenotes.coffee file as it was at <em>this specific commit</em>, but I haven’t pushed it yet. I was planning to push the footnotes changes <em>and</em> this post, together, but now I want to push the changes first. OK I did. If you prefer GitHub’s syntax highlighting, the file is <a href="https://github.com/hardscrabble/hardscrabble.github.io/blob/aba3d7fe860880cf9bd1ae93b16652b11b5d5177/_coffee/sidenotes.coffee">here</a>. If you prefer the compiled JavaScript, it’s <a href="https://github.com/hardscrabble/hardscrabble.github.io/blob/aba3d7fe860880cf9bd1ae93b16652b11b5d5177/js/sidenotes.js">here</a>. OK, now I can safely remove this sidenotes nonsense later on when I grow tired of it. <a href="#fnref:nostalgia" class="reversefootnote">↩</a></p>
    </li>
  </ol>
</div>

  </div>

  <div class="post-footer">
    <p>
      Feel free to get in touch via <a href="http://twitter.com/maxjacobson">@maxjacobson</a> or <a href="mailto:max@hardscrabble.net">max@hardscrabble.net</a>
    </p>
  </div>

</div>


<footer>
  <div>
    Powered by <a href="http://jekyllrb.com/">Jekyll</a>
    and hosted on <a href="https://pages.github.com/">GitHub Pages</a>.
    The source is <a href="https://github.com/hardscrabble/hardscrabble.github.io">available to browse, for nerds</a>.
    The feed can be found at <a href="/feed.xml">feed.xml</a>
  </div>
</footer>

<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
<script src="/js/vendor/lunr.min.js"></script>
<script src="/js/app.js"></script>


<script src="//static.getclicky.com/js" type="text/javascript"></script>
<script type="text/javascript">try{ clicky.init(100815498); }catch(e){}</script>
<noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/100815498ns.gif"></p></noscript>
</body>
</html>
